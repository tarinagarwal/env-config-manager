paths:
  /api/v1/audit-logs:
    get:
      tags:
        - Audit Logs
      summary: Query audit logs
      description: Get audit logs with filtering and pagination
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
        - in: query
          name: limit
          schema:
            type: integer
            default: 20
            maximum: 100
        - in: query
          name: userId
          schema:
            type: string
          description: Filter by user ID
        - in: query
          name: action
          schema:
            type: string
          description: Filter by action type (e.g., variable.update)
        - in: query
          name: resourceType
          schema:
            type: string
          description: Filter by resource type (e.g., variable, project)
        - in: query
          name: resourceId
          schema:
            type: string
          description: Filter by specific resource ID
        - in: query
          name: severity
          schema:
            type: string
            enum: [info, warning, critical]
          description: Filter by severity level
        - in: query
          name: startDate
          schema:
            type: string
            format: date-time
          description: Filter logs after this date
        - in: query
          name: endDate
          schema:
            type: string
            format: date-time
          description: Filter logs before this date
      responses:
        "200":
          description: Audit logs
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/AuditLog"
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                      limit:
                        type: integer
                      total:
                        type: integer
                      totalPages:
                        type: integer
              example:
                data:
                  - id: "507f1f77bcf86cd799439011"
                    userId: "507f1f77bcf86cd799439012"
                    action: variable.update
                    resourceType: variable
                    resourceId: "507f1f77bcf86cd799439013"
                    metadata:
                      key: DATABASE_URL
                      previousValue: "***MASKED***"
                      newValue: "***MASKED***"
                    ipAddress: "192.168.1.1"
                    userAgent: "Mozilla/5.0..."
                    severity: info
                    createdAt: "2024-01-01T12:00:00Z"
                pagination:
                  page: 1
                  limit: 20
                  total: 150
                  totalPages: 8

  /api/v1/audit-logs/export:
    get:
      tags:
        - Audit Logs
      summary: Export audit logs
      description: Export audit logs in JSON or CSV format
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: format
          required: true
          schema:
            type: string
            enum: [json, csv]
          description: Export format
        - in: query
          name: userId
          schema:
            type: string
        - in: query
          name: action
          schema:
            type: string
        - in: query
          name: resourceType
          schema:
            type: string
        - in: query
          name: startDate
          schema:
            type: string
            format: date-time
        - in: query
          name: endDate
          schema:
            type: string
            format: date-time
      responses:
        "200":
          description: Exported audit logs
          content:
            application/json:
              schema:
                type: object
                description: JSON export
            text/csv:
              schema:
                type: string
                description: CSV export
        "403":
          description: Export not available for your plan
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
